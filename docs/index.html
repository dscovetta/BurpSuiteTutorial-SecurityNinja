<h2 class="entry-title">Burp Suite Tutorial – Repeater and Comparer Tools</h2>

					<div class="entry-utility">
						March 19, 2010&nbsp;&nbsp;|&nbsp;&nbsp;Written by <a class="url fn n" href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/author/dr00k/" title="View all posts by Security Ninja">Security Ninja</a>&nbsp;&nbsp;|&nbsp;&nbsp;            
                          <span class="cat-links">
                <a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/category/application-security/" title="View all posts in Application Security" rel="category tag">Application Security</a>              </span>
              <span class="meta-sep">&nbsp;&nbsp;|&nbsp;&nbsp;</span>
                                    <span class="comments-link"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/application-security/burp-suite-tutorial-repeater-and-comparer-tools/#comments" title="Comment on Burp Suite Tutorial – Repeater and Comparer Tools">7 Comments</a></span>
                      </div><!-- .entry-utility -->

					<div class="entry-content">
						
<!-- AddThis Button Begin -->
<script type="text/javascript">var addthis_product = 'wpp-256';
var addthis_config = {"data_track_clickback":false};</script><script type="text/javascript" src="https://web.archive.org/web/20111230101145js_/http://s7.addthis.com/js/250/addthis_widget.js#pubid=wp-4efe26641a14a48a"></script><ul id="sharebar" style="width: 65px; margin-left: -85px; display: block; position: fixed; top: 10px;">
<li><iframe allowtransparency="true" scrolling="no" src="https://platform.twitter.com/widgets/tweet_button.1324331373.html#_=1577907087675&amp;_version=2&amp;count=vertical&amp;enableNewSizing=false&amp;id=twitter-widget-0&amp;lang=en&amp;original_referer=https%3A%2F%2Fweb.archive.org%2Fweb%2F20111230101145%2Fhttp%3A%2F%2Fwww.securityninja.co.uk%2Fapplication-security%2Fburp-suite-tutorial-repeater-and-comparer-tools%2F&amp;size=m&amp;text=Burp%20Suite%20Tutorial%20%E2%80%93%20Repeater%20and%20Comparer%20Tools%20%7C%20Security%20Ninja&amp;url=https%3A%2F%2Fweb.archive.org%2Fweb%2F20111230101145%2Fhttp%3A%2F%2Fwww.securityninja.co.uk%2Fapplication-security%2Fburp-suite-tutorial-repeater-and-comparer-tools%2F&amp;via=ThinkDevGrow" class="twitter-share-button twitter-count-vertical" style="width: 55px; height: 62px;" title="Twitter Tweet Button" frameborder="0"></iframe><script type="text/javascript" src="https://web.archive.org/web/20111230101145js_/http://platform.twitter.com/widgets.js"></script></li><li><a name="fb_share" type="button_count" href="https://web.archive.org/web/20111230102450/http://www.facebook.com/sharer.php?u=https%3A%2F%2Fweb.archive.org%2Fweb%2F20111230101145%2Fhttp%3A%2F%2Fwww.securityninja.co.uk%2Fapplication-security%2Fburp-suite-tutorial-repeater-and-comparer-tools%2F&amp;t=Burp%20Suite%20Tutorial%20%E2%80%93%20Repeater%20and%20Comparer%20Tools%20%7C%20Security%20Ninja&amp;src=sp" style="text-decoration: none;"><span class="fb_share_size_Small "><span class="FBConnectButton FBConnectButton_Small" style="cursor:pointer;"><span class="FBConnectButton_Text">Share</span></span><span class="fb_share_count_nub_right fb_share_no_count"></span><span class="fb_share_count fb_share_no_count fb_share_count_right"><span class="fb_share_count_inner">&nbsp;</span></span></span></a><script src="https://web.archive.org/web/20111230101145js_/http://static.ak.fbcdn.net/connect.php/js/FB.Share" type="text/javascript"></script></li><li><iframe src="https://web.archive.org/web/20111230101145if_/http://www.facebook.com/plugins/like.php?href=http://www.securityninja.co.uk/application-security/burp-suite-tutorial-repeater-and-comparer-tools/&amp;layout=box_count&amp;show_faces=false&amp;width=60&amp;action=like&amp;colorscheme=light&amp;height=45" scrolling="no" style="border:none; overflow:hidden; width:45px; height:60px;" allowtransparency="true" frameborder="0"></iframe></li><li><script type="text/javascript" src="https://web.archive.org/web/20111230101145js_/http://platform.linkedin.com/in.js"></script><span style="line-height: 1; vertical-align: baseline; display: inline-block; text-align: center;" class="IN-widget"><span style="padding: 0px !important; margin: 0px !important; text-indent: 0px !important; display: inline-block !important; vertical-align: baseline !important; font-size: 1px !important;"><span id="li_ui_li_gen_1577907086858_1-container" class="IN-top"><span id="li_ui_li_gen_1577907086858_1" class="IN-top"><span id="li_ui_li_gen_1577907086858_1-inner" class="IN-top"><span id="li_ui_li_gen_1577907086858_1-content" class="IN-top">0</span></span></span></span></span><br><span style="padding: 0px !important; margin: 0px !important; text-indent: 0px !important; display: inline-block !important; vertical-align: baseline !important; font-size: 1px !important;"><span id="li_ui_li_gen_1577907086839_0"><a id="li_ui_li_gen_1577907086839_0-link" href="javascript:void(0);"><span id="li_ui_li_gen_1577907086839_0-logo">in</span><span id="li_ui_li_gen_1577907086839_0-title"><span id="li_ui_li_gen_1577907086839_0-mark"></span><span id="li_ui_li_gen_1577907086839_0-title-text">Share</span></span></a></span></span></span><script type="in/share+init" data-counter="top"></script></li><li><script type="text/javascript" src="https://web.archive.org/web/20111230101145js_/http://w.sharethis.com/button/buttons.js"></script><span class="st_email_custom" displaytext="Email" st_processed="yes">email</span><span class="st_sharethis_custom" displaytext="Share" st_processed="yes">share</span></li></ul><ul id="sharebarx">
<li><iframe allowtransparency="true" scrolling="no" src="https://platform.twitter.com/widgets/tweet_button.1324331373.html#_=1577907087679&amp;_version=2&amp;count=horizontal&amp;enableNewSizing=false&amp;id=twitter-widget-2&amp;lang=en&amp;original_referer=https%3A%2F%2Fweb.archive.org%2Fweb%2F20111230101145%2Fhttp%3A%2F%2Fwww.securityninja.co.uk%2Fapplication-security%2Fburp-suite-tutorial-repeater-and-comparer-tools%2F&amp;size=m&amp;text=Burp%20Suite%20Tutorial%20%E2%80%93%20Repeater%20and%20Comparer%20Tools%20%7C%20Security%20Ninja&amp;url=https%3A%2F%2Fweb.archive.org%2Fweb%2F20111230101145%2Fhttp%3A%2F%2Fwww.securityninja.co.uk%2Fapplication-security%2Fburp-suite-tutorial-repeater-and-comparer-tools%2F&amp;via=ThinkDevGrow" class="twitter-share-button twitter-count-horizontal" style="width: 110px; height: 20px;" title="Twitter Tweet Button" frameborder="0"></iframe><script type="text/javascript" src="https://web.archive.org/web/20111230101145js_/http://platform.twitter.com/widgets.js"></script></li><li><a name="fb_share" type="button_count" href="https://web.archive.org/web/20111230102450/http://www.facebook.com/sharer.php?u=https%3A%2F%2Fweb.archive.org%2Fweb%2F20111230101145%2Fhttp%3A%2F%2Fwww.securityninja.co.uk%2Fapplication-security%2Fburp-suite-tutorial-repeater-and-comparer-tools%2F&amp;t=Burp%20Suite%20Tutorial%20%E2%80%93%20Repeater%20and%20Comparer%20Tools%20%7C%20Security%20Ninja&amp;src=sp" style="text-decoration: none;"><span class="fb_share_size_Small "><span class="FBConnectButton FBConnectButton_Small" style="cursor:pointer;"><span class="FBConnectButton_Text">Share</span></span><span class="fb_share_count_nub_right fb_share_no_count"></span><span class="fb_share_count fb_share_no_count fb_share_count_right"><span class="fb_share_count_inner">&nbsp;</span></span></span></a><script src="https://web.archive.org/web/20111230101145js_/http://static.ak.fbcdn.net/connect.php/js/FB.Share" type="text/javascript"></script></li><li><iframe src="https://web.archive.org/web/20111230101145if_/http://www.facebook.com/plugins/like.php?href=http://www.securityninja.co.uk/application-security/burp-suite-tutorial-repeater-and-comparer-tools/&amp;layout=button_count&amp;show_faces=false&amp;width=85&amp;action=like&amp;colorscheme=light&amp;height=21" scrolling="no" style="border:none; overflow:hidden; width:85px; height:21px;" allowtransparency="true" frameborder="0"></iframe></li><li><script type="text/javascript" src="https://web.archive.org/web/20111230101145js_/http://platform.linkedin.com/in.js"></script><span style="line-height: 1; vertical-align: baseline; display: inline-block; text-align: center;" class="IN-widget"><span style="padding: 0px !important; margin: 0px !important; text-indent: 0px !important; display: inline-block !important; vertical-align: baseline !important; font-size: 1px !important;"><span id="li_ui_li_gen_1577907087691_3-container" class="IN-top"><span id="li_ui_li_gen_1577907087691_3" class="IN-top"><span id="li_ui_li_gen_1577907087691_3-inner" class="IN-top"><span id="li_ui_li_gen_1577907087691_3-content" class="IN-top">0</span></span></span></span></span><br><span style="padding: 0px !important; margin: 0px !important; text-indent: 0px !important; display: inline-block !important; vertical-align: baseline !important; font-size: 1px !important;"><span id="li_ui_li_gen_1577907087688_2"><a id="li_ui_li_gen_1577907087688_2-link" href="javascript:void(0);"><span id="li_ui_li_gen_1577907087688_2-logo">in</span><span id="li_ui_li_gen_1577907087688_2-title"><span id="li_ui_li_gen_1577907087688_2-mark"></span><span id="li_ui_li_gen_1577907087688_2-title-text">Share</span></span></a></span></span></span><script type="in/share+init" data-counter="top"></script></li><li><span class="st_email_custom" displaytext="Email" st_processed="yes">Email</span><span class="st_sharethis_custom" displaytext="Share" st_processed="yes">Share</span></li></ul><p style="text-align: justify;">Hi everyone,</p>
<p style="text-align: justify;">I was very happy to see that a lot of people liked the <a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/burp-suite-tutorial-the-intruder-tool">Burp Suite Tutorial</a> (Intruder Tool) blog post last week. I plan to publish more tutorials for the Burp Suite and this week I will be covering the Repeater and Comparer tools.</p>
<p style="text-align: justify;"><strong>What are the Repeater and Comparer tools?</strong></p>
<p style="text-align: justify;">The Burp Suite is made up of multiple tools and today we will be taking a look at the Repeater and Comparer tools (descriptions take from the Port Swigger website):</p>
<p style="text-align: justify;"><strong>Repeater</strong>: Burp Repeater is a tool for manually modifying and reissuing individual HTTP requests, and analysing their responses. It is best used in conjunction with the other Burp Suite tools. For example, you can send a request to Repeater from the target site map, from the Burp Proxy browsing history, or from the results of a Burp Intruder attack, and manually adjust the request to fine-tune an attack or probe for vulnerabilities.</p>
<p style="text-align: justify;"><strong>Comparer</strong>: Burp Comparer is a simple tool for performing a comparison (a visual “diff”) between any two items of data. In the context of attacking a web application, this requirement will typically arise when you want to quickly identify the differences between two application responses (for example, between two responses received in the course of a Burp Intruder attack, or between responses to a failed login using valid and invalid usernames), or between two application requests (for example, to identify the different request parameters that give rise to different behaviour).</p>
<p style="text-align: justify;">I explained how to use the Intruder tool in the last blog post and I will show you how to use the Repeater and Comparer tools this week. We will run the same Intruder tests as last week and show you how you can use the Repeater and Comparer tools to perform additional testing based on the intruder test results. The first part of the tutorial is very similar to the Intruder tool because we will use the results from the intruder test to demonstrate the Repeater and Comparer tools.</p>
<p style="text-align: justify;"><strong>Enabling the Burp Suite Proxy</strong></p>
<p style="text-align: justify;">To begin using the Burp Suite to test our example web application we need configure our web browser to use the Burp Suite as a proxy. The Burp Suite proxy will use port 8080 by default but you can change this if you want to.</p>
<p style="text-align: justify;">You can see in the image below that I have configured Firefox to use the Burp Suite proxy for all traffic.</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/FF-PRoxy2.JPG"><img class="aligncenter size-full wp-image-1232" title="FF PRoxy" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/FF-PRoxy2.JPG" alt="FF PRoxy" width="414" height="448"></a></p>
<p style="text-align: justify;">When you open the Burp Suite go to the proxy tool and check that the proxy is running by clicking on the options tab:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp17.JPG"><img class="aligncenter size-medium wp-image-1233" title="Burp1" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp17-560x446.jpg" alt="Burp1" width="560" height="446"></a></p>
<p style="text-align: justify;">You can see that the proxy is using the default port:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp21.JPG"><img class="aligncenter size-medium wp-image-1234" title="Burp2" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp21-560x446.jpg" alt="Burp2" width="560" height="446"></a></p>
<p style="text-align: justify;">The proxy is now running and ready to use. You can see that the proxy options tab has quite a few items that we can configure to meet our testing needs. A lot of these items are out side of the scope of this tutorial.</p>
<p style="text-align: justify;">The Burp Suite will now begin logging the requests and responses that pass through the proxy. We have browsed to the logon page of our example application and the Burp Suite proxy has captured the request and response:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp31.JPG"><img class="aligncenter size-medium wp-image-1235" title="Burp3" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp31-560x435.jpg" alt="Burp3" width="560" height="435"></a></p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp41.JPG"><img class="aligncenter size-medium wp-image-1236" title="Burp4" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp41-560x446.jpg" alt="Burp4" width="560" height="446"></a></p>
<p style="text-align: justify;">The logon page is very simple, we have two input points that we need to test for input validation weaknesses.</p>
<p style="text-align: justify;">We need to capture a logon request and replace the username and password values with our test inputs.</p>
<p style="text-align: justify;">To do this we must ensure that the Burp Suite proxy is configured to intercept our requests:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp71.JPG"><img class="aligncenter size-medium wp-image-1237" title="Burp7" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp71-560x446.jpg" alt="Burp7" width="560" height="446"></a></p>
<p style="text-align: justify;">With the intercept enabled we will submit the logon form and send it to the intruder as you can see below:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp81.JPG"><img class="aligncenter size-medium wp-image-1238" title="Burp8" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp81-560x446.jpg" alt="Burp8" width="560" height="446"></a></p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp91.JPG"><img class="aligncenter size-medium wp-image-1239" title="Burp9" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp91-560x446.jpg" alt="Burp9" width="560" height="446"></a></p>
<p style="text-align: justify;">The Burp Suite will send our request to the intruder tool so we can begin our testing. You can see the request in the intruder tool below:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp101.JPG"><img class="aligncenter size-medium wp-image-1240" title="Burp10" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp101-560x446.jpg" alt="Burp10" width="560" height="446"></a></p>
<p style="text-align: justify;">The tool has automatically created payload positions for us. The payload positions are defined using the § character, the intruder will replace the value between two § characters with one of our test inputs.</p>
<p style="text-align: justify;"><strong>Selecting a payload</strong></p>
<p style="text-align: justify;">So far we have enabled the Burp Suite proxy, captured a request, sent it to the intruder tool and marked our payload positions. We now need to tell the intruder tool what values to insert into the positions.</p>
<p style="text-align: justify;">To define our payloads we need to click on the payloads tab within the intruder tool:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp112.JPG"><img class="aligncenter size-medium wp-image-1241" title="Burp11" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp112-560x446.jpg" alt="Burp11" width="560" height="446"></a></p>
<p style="text-align: justify;">We are going to use the sniper attack type in this example so we only have one payload set. The dropdown menu next to the payload set number allows you perform many different types of testing/data manipulation.</p>
<p style="text-align: justify;">We are going to use a predefined list of inputs for our testing:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Payloads1.JPG"><img class="aligncenter size-medium wp-image-1242" title="Payloads" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Payloads1-560x446.jpg" alt="Payloads" width="560" height="446"></a></p>
<p style="text-align: justify;"><strong>Configuring intruder options</strong></p>
<p style="text-align: justify;">The options tab in the intruder tool allows you to configure additional test parameters including a grep function, enabling a DOS mode and deciding how you want the Burp Suite to handle 3xx redirects.</p>
<p style="text-align: justify;">For this example we are going to the grep function to perform a simple pattern match. The Burp Suite will provide you with a default list of words to match against but we are going to remove these and add our own for this test.</p>
<p style="text-align: justify;">The logon form that we are going to test uses an XML file containing usernames and passwords to authenticate our users. The username and password values we provide will be entered into an XPATH query. If the application fails to securely validate these values an XPATH Injection vulnerability could exist.</p>
<p style="text-align: justify;">We want the intruder tool perform a pattern match for us using the word “XPATH”. This should allow us to easily identify any XPATH errors caused by our test inputs:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp122.JPG"><img class="aligncenter size-medium wp-image-1243" title="Burp12" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp122-560x446.jpg" alt="Burp12" width="560" height="446"></a></p>
<p style="text-align: justify;"><strong>Executing our tests</strong></p>
<p style="text-align: justify;">The only thing left for us to do now is to execute our tests.</p>
<p style="text-align: justify;">To start the intruder tool you need to click “intruder” on the top menu and then click on “start”:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp132.JPG"><img class="aligncenter size-medium wp-image-1244" title="Burp13" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp132-560x446.jpg" alt="Burp13" width="560" height="446"></a></p>
<p style="text-align: justify;">A separate window will be opened which will show you each test, the payload used, the status code, length and in our case the tests which match our XPATH pattern match word:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp141.JPG"><img class="aligncenter size-medium wp-image-1245" title="Burp14" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp141-560x446.jpg" alt="Burp14" width="560" height="446"></a></p>
<p style="text-align: justify;">You can see that some of the tests matched our pattern match word by looking at the tick boxes in the XPATH column.</p>
<p style="text-align: justify;">To review the request and the response for each test you can double click any of the requests shown in the attack window.</p>
<p style="text-align: justify;">We are going to review request 13 which entered a single quote (‘) into the username field:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp151.JPG"><img class="aligncenter size-medium wp-image-1246" title="Burp15" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp151-560x446.jpg" alt="Burp15" width="560" height="446"></a></p>
<p style="text-align: justify;">This single quote caused an XPATH error to be thrown by the application:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp161.JPG"><img class="aligncenter size-medium wp-image-1247" title="Burp16" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp161-560x446.jpg" alt="Burp16" width="560" height="446"></a></p>
<p style="text-align: justify;">So as you can see we have used the Burp Suite intruder tool to identify a potential XPATH injection vulnerability.</p>
<p style="text-align: justify;"><strong>Fine tuning the attack with the Repeater Tool</strong></p>
<p style="text-align: justify;">The Repeater tool will allow us to manually modify and submit requests and view the response within the Burp Suite. We can use the Repeater tool to manually test any potential vulnerabilities that have been highlighted by the Intruder tool. This approach allows us to submit a large amount of requests (84 in this example) automatically with the Intruder tool and fine tune any “interesting” requests (4 in this example) with the Repeater. The Intruder tool has highlighted 4 responses which include our pattern matching keyword “XPATH”.</p>
<p style="text-align: justify;">We will right click request number 13 (the same request as we looked at above) and send this to the Repeater tool:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp18.JPG"><img class="aligncenter size-medium wp-image-1248" title="Burp1" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp18-560x446.jpg" alt="Burp1" width="560" height="446"></a></p>
<p style="text-align: justify;">The Burp Suite will send request number 13 to the Repeater tool as shown below:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp22.JPG"><img class="aligncenter size-medium wp-image-1249" title="Burp2" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp22-560x446.jpg" alt="Burp2" width="560" height="446"></a></p>
<p style="text-align: justify;">We have seen in the Intruder tool that entering a single quote (‘) into the username field gives us an XPATH error. This could potentially be exploited by a malicious user to bypass our authentication check.</p>
<p style="text-align: justify;">In the Repeater tool you modify the request however you want and click on the “go” button. The response will be shown in the bottom pane of the Repeater tool:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp32.JPG"><img class="aligncenter size-medium wp-image-1250" title="Burp3" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp32-560x446.jpg" alt="Burp3" width="560" height="446"></a></p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp42.JPG"><img class="aligncenter size-medium wp-image-1251" title="Burp4" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp42-560x446.jpg" alt="Burp4" width="560" height="446"></a></p>
<p style="text-align: justify;">We want to use the Repeater tool to fine tune our attack against the username field so we can replace the username and password value with different inputs and submit these individual requests.</p>
<p style="text-align: justify;">The error message we received in the response shown above was:</p>
<p style="text-align: justify;"><strong>Incorrect username: Invalid XPath expression: //users/user[username=''']/password Expected: ]</strong></p>
<p style="text-align: justify;">You can see that our single quote is breaking the XPATH query. We need to use these error messages to our advantage. If we continue to modify the username value we should eventually be able to exploit this vulnerability thanks to the lack of input validation and the informative error messages.</p>
<p style="text-align: justify;">The informative error messages will help us exploit this flaw because we can see that the XPATH query looks something like this:</p>
<p style="text-align: justify;"><strong>//users/user[username=' “username supplied by user” ']/password</strong></p>
<p style="text-align: justify;">It should now be obvious why our single quote broke the query. We can manually modify the username value using the Repeater tool until we find an input that doesn’t break the query and allows us to authenticate without knowing a valid username.</p>
<p style="text-align: justify;">In the image below you can see that we have replaced the single quote with a different input which allows us to move closer to exploiting this flaw:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp5.JPG"><img class="aligncenter size-medium wp-image-1252" title="Burp5" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp5-560x446.jpg" alt="Burp5" width="560" height="446"></a></p>
<p style="text-align: justify;">When we use the Repeater to submit a request where the username value is<strong> ‘ or ’1′ =’1</strong> we get a different error. The error tells us the password (blank in the request) we submitted was incorrect. The XPATH query will now look something like this:</p>
<p style="text-align: justify;">//users/user[username=' <strong>' or '1' ='1</strong> ']/password</p>
<p style="text-align: justify;">This means that the username value we submitted is “OK” and we now need to guess a password value. We can brute force this value using the Intruder tool as we saw in the Intruder tool tutorial. I would like you to assume that I have brute forced this value using the Intruder tool and I have entered it into the Repeater tool below:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp6.JPG"><img class="aligncenter size-medium wp-image-1253" title="Burp6" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp6-560x446.jpg" alt="Burp6" width="560" height="446"></a></p>
<p style="text-align: justify;">By passing in the <strong>‘ or ’1′ =’1</strong> value as the username and our brute forced password value we have successfully logged into the Payment Page of our application.</p>
<p style="text-align: justify;"><strong>Comparing responses with the Comparer tool</strong></p>
<p style="text-align: justify;">The Comparer tool allows us to compare multiple requests and responses to easily see the differences between them. In our Intruder tool test you can see that tests 9, 13 and 23 all matched our pattern matching keyword but the size of the responses were all slightly different.</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp142.JPG"><img class="aligncenter size-medium wp-image-1254" title="Burp14" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp142-560x446.jpg" alt="Burp14" width="560" height="446"></a></p>
<p style="text-align: justify;">We can use the Comparer tool to compare the three responses and show us the differences between them by right clicking them in Intruder attack window and selecting “send response to comparer”:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp72.JPG"><img class="aligncenter size-medium wp-image-1255" title="Burp7" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp72-560x446.jpg" alt="Burp7" width="560" height="446"></a></p>
<p style="text-align: justify;">In the image below you can see that all three of the responses are now in the Comparer tool:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp82.JPG"><img class="aligncenter size-medium wp-image-1256" title="Burp8" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp82-560x446.jpg" alt="Burp8" width="560" height="446"></a></p>
<p style="text-align: justify;">You can select two responses and click on one of the two compare types (descriptions take from the Port Swigger website):</p>
<p style="text-align: justify;"><strong>Words</strong>: This comparison tokenises each item based on whitespace delimiters, and identifies the token-level edits required to transform the first item into the second. It is most useful when the interesting differences between the compared items exist at the “word” level, for example in HTML documents containing different content.</p>
<p style="text-align: justify;"><strong>Bytes</strong>: This comparison identifies the byte-level edits required to transform the first item into the second. It is most useful when the interesting differences between the compared items exist at the “byte” level, for example in HTTP requests containing subtly different values in a particular parameter or cookie.</p>
<p style="text-align: justify;">We are going to use the words comparer to compare request number 3 against request number 5:</p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp92.JPG"><img class="aligncenter size-medium wp-image-1257" title="Burp9" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp92-560x446.jpg" alt="Burp9" width="560" height="446"></a></p>
<p style="text-align: justify;"><a href="https://web.archive.org/web/20111230101145/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp102.JPG"><img class="aligncenter size-medium wp-image-1258" title="Burp10" src="https://web.archive.org/web/20111230101145im_/http://www.securityninja.co.uk/wp-content/uploads/2010/03/Burp102-560x446.jpg" alt="Burp10" width="560" height="446"></a></p>
<p style="text-align: justify;">You can see that the main difference between the two requests is the XPATH error message that is returned. The response with the smaller length does not have “password expected” in its error message.</p>
<p style="text-align: justify;">I hope you have found this blog post useful and I’m always interested in hearing any feedback you have.</p>
<p style="text-align: justify;">SN</p>
